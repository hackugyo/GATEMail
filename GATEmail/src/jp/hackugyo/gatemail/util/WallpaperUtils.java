package jp.hackugyo.gatemail.util;import java.io.IOException;import android.app.WallpaperManager;import android.content.Context;import android.graphics.Bitmap;import android.graphics.BitmapFactory;/** * 壁紙の設定 * @see <a href="http://stackoverflow.com/questions/7383361/android-wallpapermanager-crops-image">参考ページ</a> */public class WallpaperUtils {    public static void setWallpaper(Context context, int resId) throws IOException {        context.enforceCallingOrSelfPermission(android.Manifest.permission.SET_WALLPAPER, "need permission: SET_WALLPAPER");        // SET_WALLPAPERだけでよい．SET_WALLPAPER_HINTSはホーム画面アプリ用なので注意        // http://developer.android.com/reference/android/app/WallpaperManager.html#suggestDesiredDimensions(int, int)                WallpaperManager wallpaperManager = WallpaperManager.getInstance(context);        //import non-scaled bitmap wall paper        BitmapFactory.Options options = new BitmapFactory.Options();        options.inScaled = false;        Bitmap wallpaper = BitmapFactory.decodeResource(context.getResources(), resId, options);        if (wallpaperManager.getDesiredMinimumWidth() > wallpaper.getWidth() &&                wallpaperManager.getDesiredMinimumHeight() > wallpaper.getHeight()) {            //add padding to wall paper so background image scales correctly            int xPadding = Math.max(0, wallpaperManager.getDesiredMinimumWidth() - wallpaper.getWidth()) / 2;            int yPadding = Math.max(0, wallpaperManager.getDesiredMinimumHeight() - wallpaper.getHeight()) / 2;            Bitmap paddedWallpaper = Bitmap.createBitmap(wallpaperManager.getDesiredMinimumWidth(), wallpaperManager.getDesiredMinimumHeight(), Bitmap.Config.ARGB_8888);            int[] pixels = new int[wallpaper.getWidth() * wallpaper.getHeight()];            wallpaper.getPixels(pixels, 0, wallpaper.getWidth(), 0, 0, wallpaper.getWidth(), wallpaper.getHeight());            paddedWallpaper.setPixels(pixels, 0, wallpaper.getWidth(), xPadding, yPadding, wallpaper.getWidth(), wallpaper.getHeight());            wallpaperManager.setBitmap(paddedWallpaper);        } else {            wallpaperManager.setBitmap(wallpaper);        }    }}